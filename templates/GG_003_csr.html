{% extends 'base.html' %}

{% block title %}ê±´ì„¤ í˜„ì¥ ê´€ë¦¬{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/GG_003_csr.css" />
{% endblock %}

{% block content %}

<!-- í”Œë˜ì‹œ ë©”ì‹œì§€ -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="flash-message-wrapper">
      {% for category, message in messages %}
        <div class="flash-message {{ category }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<div id="character">âœ¨</div>

<div class="flex-wrapper">

  <!-- ì§€ë„ ì˜ì—­ -->
  <div id="map" style="width:1100px; height:750px; background-color:white; position:relative;">
    <input id="search-input4" placeholder="í˜„ì¥ëª… ê²€ìƒ‰" />
    <div id="autocomplete-results"
         style="display:none; position:absolute; top:30px; left:10px; z-index:100; background:white; border:1px solid #ccc; max-height:150px; overflow-y:auto;">
    </div>
    <button type="button" id="Button5">í˜„ì¥ìœ¼ë¡œ ì´ë™</button>
  </div>

  <!-- ë“±ë¡/ìˆ˜ì •/ì‚­ì œ í¼ ì˜ì—­ -->
  <div class="container">
    <div class="title-container">
      <h1 style="color:white;">ê±´ì„¤ í˜„ì¥ ë“±ë¡Â·ìˆ˜ì •Â·ì‚­ì œ</h1>
    </div>

    <div class="div1">
      <form id="siteForm" method="POST" action="/csr/register_site">
        <div id="search-box">
          <label>í˜„ì¥ëª…</label><br>
          <input type="text" name="site_name" id="search-input1" placeholder="ê±´ì„¤í˜„ì¥ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" required /><br>

          <label>ì£¼ì†Œ</label><br>
          <input type="text" name="address" id="search-input2" placeholder="ê±´ì„¤í˜„ì¥ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”" required /><br>

          <label>ë‹´ë‹¹ìëª…</label><br>
          <input type="text" name="manager_name" id="search-input3" placeholder="ë‹´ë‹¹ìë¥¼ ì…ë ¥í•˜ì„¸ìš”" required /><br>

          <!-- ì‹ë³„ìš© site_id -->
          <input type="hidden" name="site_id" id="site_id" value="" />
          <!-- ìœ„ì¹˜ ì •ë³´ (í•„ìš” ì‹œ ì‚¬ìš©) -->
          <input type="hidden" name="latitude" id="latitude" />
          <input type="hidden" name="longitude" id="longitude" />

          <label>íšŒì‚¬ ì„ íƒ</label><br>
          <div style="display:flex; gap:10px; align-items:center;">
            <select name="company_id" id="companySelect">
              {% for company in companies %}
                <option value="{{ company.company_id }}">{{ company.company_name }}</option>
              {% endfor %}
            </select>
            <button type="button" id="openCompanyModal">+ íšŒì‚¬ ì¶”ê°€</button>
          </div>
        </div>

        <div class="div2">
          <h2 style="color:white;">ìì¬ë“±ë¡</h2>
          <div class="excel-upload">
            <label for="excelInput" class="excel-btn">ğŸ“ ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ</label>
            <input type="file" id="excelInput" accept=".xlsx,.xls" style="display:none;" />
          </div>
        </div>

        <div class="button-group">
          <button type="submit"       id="Button1">Create</button>
          <button type="button"       id="ButtonUpdate">Update</button>
          <button type="button"       id="ButtonDelete">Delete</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- íšŒì‚¬ ë“±ë¡ ëª¨ë‹¬ -->
<div id="companyModal" class="modal" style="display:none;">
  <form method="POST" action="/csr/register_company">
    <h2>íšŒì‚¬ ë“±ë¡</h2>
    <label>íšŒì‚¬ëª…</label><br>
    <input type="text" name="company_name" required><br><br>
    <label>ì£¼ì†Œ</label><br>
    <input type="text" name="address"><br><br>
    <label>ëŒ€í‘œìëª…</label><br>
    <input type="text" name="ceo_name"><br><br>
    <label>ì—°ë½ì²˜</label><br>
    <input type="text" name="contact"><br><br>
    <div style="text-align:right;">
      <button type="submit">ë“±ë¡</button>
      <button type="button" onclick="document.getElementById('companyModal').style.display='none'">ë‹«ê¸°</button>
    </div>
  </form>
</div>

<!-- Kakao Maps SDK -->
<script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=30b3dfc1e244b48dfa1c16cec788c438&libraries=services"></script>
<!-- ì»¤ìŠ¤í…€ JS -->
<script src="/static/js/GG_003_csr.js"></script>
<script>
  document.getElementById('openCompanyModal').onclick = function() {
    document.getElementById('companyModal').style.display = 'block';
  };
</script>

{% endblock %}
